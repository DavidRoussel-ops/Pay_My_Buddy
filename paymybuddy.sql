
SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

CREATE DATABASE paymybuddy;

CREATE TABLE `USER` (
`ID` int UNSIGNED NOT NULL,
`USERNAME` varchar(100) NOT NULL,
`EMAIL` varchar(255) NOT NULL,
`PASSWORD` varchar(255) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `TRANSACTION` (
`ID` int UNSIGNED NOT NULL,
`DESCRIPTION` varchar(255) NOT NULL,
`AMOUNT` double NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `USER_FRIENDS` (
`ID` int UNSIGNED NOT NULL,
`USER_FRIEND_ID` int NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `USER_TRANSACTION_RECEIVER` (
`ID` int UNSIGNED NOT NULL,
`USER_ID` int NULL,
`TRANSACTION_ID` int NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `USER_TRANSACTION_SENDER` (
`ID` int UNSIGNED NOT NULL,
`USER_ID` int NULL,
`TRANSACTION_ID` int NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE `USER_FRIENDS`
ADD FOREIGN KEY (`USER_FRIEND_ID`) REFERENCES `USER` (`ID`)
ON DELETE CASCADE ON UPDATE;

ALTER TABLE `USER_TRANSACTION_RECEIVER`
ADD FOREIGN KEY (`USER_ID`) REFERENCES `USER` (`ID`)
ON DELETE CASCADE ON UPDATE CASCADE,
ADD FOREIGN KEY (`TRANSACTION_ID`) REFERENCES `TRANSACTION` (`ID`)
ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE `USER_TRANSACTION_SENDER`
ADD FOREIGN KEY (`USER_ID`) REFERENCES `USER` (`ID`)
ON DELETE CASCADE ON UPDATE CASCADE,
ADD FOREIGN KEY (`TRANSACTION_ID`) REFERENCES `TRANSACTION` (`ID`)
ON DELETE CASCADE ON UPDATE CASCADE;

COMMIT;